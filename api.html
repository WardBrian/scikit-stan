
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API Reference &#8212; SciKit Stan  documentation</title>
  <script>
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=9b1a4fa89bdd0e95b23b" rel="stylesheet">

  
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/6.1.2/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Internal API Reference" href="internal_api.html" />
    <link rel="prev" title="Getting Started" href="getting-started.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fas fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">SciKit Stan  documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="getting-started.html">
                        Getting Started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="examples.html">
                        Examples
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      <div class="navbar-end-item navbar-end__search-button-container">
        
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
      </div>
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/WardBrian/scikit-stan" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://discourse.mc-stan.org/" title="Forums" class="nav-link" rel="noopener" target="_blank"><span><i class="fas fa-users"></i></span>
            <label class="sr-only">Forums</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  <div class="search-button-container--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search">
  <i class="fas fa-search"></i>
</button>
  </div>

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fas fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                <li class="nav-item">
                    <a class="nav-link" href="getting-started.html">
                        Getting Started
                    </a>
                </li>
                

                <li class="nav-item current active">
                    <a class="nav-link" href="#">
                        API Reference
                    </a>
                </li>
                

                <li class="nav-item">
                    <a class="nav-link" href="examples.html">
                        Examples
                    </a>
                </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <span class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://github.com/WardBrian/scikit-stan" title="GitHub" class="nav-link" rel="noopener" target="_blank"><span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          <a href="https://discourse.mc-stan.org/" title="Forums" class="nav-link" rel="noopener" target="_blank"><span><i class="fas fa-users"></i></span>
            <label class="sr-only">Forums</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Section navigation">
  <p class="bd-links__title" role="heading" aria-level="1">
    Section Navigation
  </p>
  <div class="bd-toc-item navbar-nav">
    <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="internal_api.html">
   Internal API Reference
  </a>
 </li>
</ul>

  </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

      </div>
      <main class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="api-reference">
<h1>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading">#</a></h1>
<p>The stable API of scikit-stan. This will remain stable between versions, with the proimse of backwards compatibility between minor versions and ample warnings prior to large changes to the API.</p>
<p>This package also has an <a class="reference external" href="internal_api.html">internal API</a>, which is not stable and is not meant to be used by users, but contains useful functions
for developers seeking to add additional models or improve existing models.</p>
<div class="toctree-wrapper compound">
</div>
<section id="generalized-linear-model">
<h2>Generalized Linear Model<a class="headerlink" href="#generalized-linear-model" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="scikit_stan.GLM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">scikit_stan.</span></span><span class="sig-name descname"><span class="pre">GLM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">family</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gaussian'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">link</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_intercept</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prior_aux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autoscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scikit_stan/generalized_linear_regression/glm.html#GLM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scikit_stan.GLM" title="Permalink to this definition">#</a></dt>
<dd><p>A generalized linear model estimator with several options for families, links,
and priors on regression coefficients, the intercept, and error scale,
done in an scikit-learn style.
This class also provides an autoscaling feature of the priors.
For deterministic behavior from this model, the class’s seed can be set and is then
passed to Stan computations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>algorithm</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – <p>Algorithm to be used by the Stan model. The following are supported:</p>
<blockquote>
<div><ul>
<li><p>sample - runs the HMC-NUTS sampler,</p></li>
<li><p>optimize - produces a likelihood estimate of model parameters,</p></li>
<li><p>variational - runs Stan’s variational inference algorithm to compute the posterior.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>algorithm_params</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Any]</span></code>, <em>optional</em>) – <p>Parameters for the selected algorithm. The key words
and values are derived from CmdStanPy’s API,
so please refer to
this documentation for more information:
<a class="reference external" href="https://mc-stan.org/cmdstanpy/api.html#cmdstanmodel">https://mc-stan.org/cmdstanpy/api.html#cmdstanmodel</a></p>
<p>Customizing these fields is done via a passed dictionary, which is validated
on the level of CmdStan. As an example, to specify the number of chains for
the HMC-NUTS sampler to run, it is sufficient to pass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;chains&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or to specify the number of warmup and sampling
iterations, pass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;iter_warmup&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
    <span class="s2">&quot;iter_sampling&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="p">},</span>
</pre></div>
</div>
<p>Default Stan parameters are used if nothing is passed.</p>
</p></li>
<li><p><strong>fit_intercept</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – <p>Whether the GLM should fit a global intercept. Some hierarchical models operate
without an intercept, so setting this to False will fill the first column of the
predictor matrix with ones.</p>
<p>By default, the GLM has an intercept term – the first column of the predictor
matrix X is used for inference of the intercept.</p>
</p></li>
<li><p><strong>family</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <em>optional</em>) – <p>Distribution family used for linear regression. All R Families package are supported:</p>
<blockquote>
<div><ul>
<li><p>”gaussian” - Gaussian distribution,</p></li>
<li><p>”gamma” - Gamma distribution,</p></li>
<li><p>”inverse-gaussian” - Inverse Gaussian distribution,</p></li>
<li><p>”poisson” - Poisson distribution,</p></li>
<li><p>”binomial” - Binomial distribution</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>link</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[str]</span></code>, <em>optional</em>) – <p>Distribution link function used for linear regression,
following R’s family-link combinations.
These are family-specific:</p>
<blockquote>
<div><ul>
<li><dl class="simple">
<dt>”gaussian”:</dt><dd><ul>
<li><p>”identity” - Identity link function,</p></li>
<li><p>”log” - Log link function,</p></li>
<li><p>”inverse” - Inverse link function</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”gamma”:</dt><dd><ul>
<li><p>”identity” - Identity link function,</p></li>
<li><p>”log” - Log link function,</p></li>
<li><p>”inverse” - Inverse link function</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”inverse-gaussian”:</dt><dd><ul>
<li><p>”identity” - Identity link function,</p></li>
<li><p>”log” - Log link function,</p></li>
<li><p>”inverse” - Inverse link function,</p></li>
<li><p>”inverse-square” - Inverse square link function</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”poisson”:</dt><dd><ul>
<li><p>”identity” - Identity link function,</p></li>
<li><p>”log” - Log link function,</p></li>
<li><p>”sqrt” - Square root link function</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”binomial”:</dt><dd><ul>
<li><p>”log” - Log link function,</p></li>
<li><p>”logit” - Logit link function,</p></li>
<li><p>”probit” - Probit link function,</p></li>
<li><p>”cloglog” - Complementary log-log link function,</p></li>
<li><p>”cauchit” - Cauchit link function</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>If an invalid combination of family and link is passed, a ValueError is raised.</p>
<p>When no link is specified, these are family-specific defaults for the link function:</p>
<blockquote>
<div><ul>
<li><p>”gaussian”: “identity”,</p></li>
<li><p>”gamma”: “inverse”,</p></li>
<li><p>”inverse-gaussian”: “inverse”,</p></li>
<li><p>”poisson”: “identity”,</p></li>
<li><p>”binomial”: “logit”</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>seed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[int]</span></code>, <em>optional</em>) – Seed for random number generator. Must be an integer between 0 an 2^32-1.
If this is left unspecified, then a random seed will be used for all chains
via <a class="reference external" href="https://numpy.org/doc/stable/reference/random/legacy.html#numpy.random.RandomState" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.random.RandomState</span></code></a>.
Specifying this field will yield the same result for multiple uses if
all other parameters are held the same.</p></li>
<li><p><strong>priors</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Union[int</span></code>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">List]]]</span></code>, <em>optional</em>) – <p>Dictionary for configuring prior distribution on coefficients.
Currently supported priors are: “normal”, and “laplace”.</p>
<p>By default, all regression coefficient priors are set to</p>
<div class="math notranslate nohighlight">
\[\beta \sim \text{normal}(0, 2.5 \cdot \text{sd}(y) / \text{sd}(X))\]</div>
<p>if Gaussian, else</p>
<div class="math notranslate nohighlight">
\[\beta \sim \text{normal}(0, 2.5 / \text{sd}(X))\]</div>
<p>if auto_scale is True, otherwise</p>
<div class="math notranslate nohighlight">
\[\beta \sim \text{normal}(0, 2.5 \cdot \text{sd}(y))\]</div>
<p>if Gaussian else</p>
<div class="math notranslate nohighlight">
\[\beta \sim \text{normal}(0, 2.5)\]</div>
<p>If an empty dictionary {} is passed, no priors are used and
the default Stan uniform(-inf, inf) prior is used for all coefficients.</p>
<p>The number of specified prior parameters cannot exceed the number of predictors in
the data as each parameter is associated with a single coefficient.
If the number of specified priors is less than the number of predictors,
the remaining coefficients are set to the default prior.
The prior on all regression coefficients is set with the following keys:</p>
<blockquote>
<div><ul>
<li><p>”prior_slope_dist”: distribution of the prior for each coefficient</p></li>
<li><p>”prior_slope_mu”: list of location parameters of the prior for each coefficient</p></li>
<li><p>”prior_slope_sigma”: list of scale parameters of the prior for each coefficient</p></li>
</ul>
</div></blockquote>
<p>Thus, to specify a standard normal prior on the first feature,
the dictionary should be passed as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;prior_slope_dist&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;prior_slope_mu&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.</span><span class="p">],</span>
    <span class="s2">&quot;prior_slope_sigma&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Any unspecified priors will be set to the default.</p>
<p>Also note that choosing a Laplace prior is equivalent to L1 regularization:
<a class="reference external" href="https://stats.stackexchange.com/questions/177210/why-is-laplace-prior-producing-sparse-solutions/177217#177217">https://stats.stackexchange.com/questions/177210/why-is-laplace-prior-producing-sparse-solutions/177217#177217</a></p>
</p></li>
<li><p><strong>prior_intercept</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Any]]</span></code>, <em>optional</em>) – <p>Prior for the intercept alpha parameter for GLM.
If this is not specified, the default is</p>
<div class="math notranslate nohighlight">
\[\alpha \sim \text{normal}(\text{mu}(y), 2.5 \cdot \text{sd}(y))\]</div>
<p>if Gaussian family else</p>
<div class="math notranslate nohighlight">
\[\alpha \sim \text{normal}(0, 2.5)\]</div>
<p>If an empty dictionary {} is passed, the default Stan uniform(-inf, inf) prior is used.</p>
<p>To set this prior explicitly, pass a dictionary with the following keys:</p>
<blockquote>
<div><ul>
<li><p>”prior_intercept_dist”: str, distribution of the prior from the list of supported
prior distributions: “normal”, “laplace”</p></li>
<li><p>”prior_intercept_mu”: float, location parameter of the prior distribution</p></li>
<li><p>”prior_intercept_sigma”: float, error scale parameter of the prior distribution</p></li>
</ul>
</div></blockquote>
<p>Thus, for example, passing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;prior_intercept_dist&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>
    <span class="s2">&quot;prior_intercept_mu&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;prior_intercept_sigma&quot;</span><span class="p">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
<p>results in</p>
<div class="math notranslate nohighlight">
\[\alpha \sim \text{normal}(0, 1)\]</div>
<p>by default (without autoscaling, see below).</p>
<p>Also note that choosing a Laplace prior is equivalent to L1 regularization:
<a class="reference external" href="https://stats.stackexchange.com/questions/177210/why-is-laplace-prior-producing-sparse-solutions/177217#177217">https://stats.stackexchange.com/questions/177210/why-is-laplace-prior-producing-sparse-solutions/177217#177217</a></p>
</p></li>
<li><p><strong>prior_aux</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Optional[Dict[str</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">Any]]</span></code>, <em>optional</em>) – <p>Prior on the auxiliary parameter for the family used in
the regression: for example, the std for Gaussian, shape for gamma, etc…
Currently supported priors are: “exponential”, “chi2”, “gamma”, and “inv_gamma”.
These are parameterized by the following distribution parameters:
“beta”, “nu”, “alpha” and “beta”, and “alpha” and “beta”, respectively.</p>
<p>Priors here with more parameters are a future feature.</p>
<p>If an empty dictionary {} is passed, the default Stan uniform(-inf, inf) prior is used.</p>
<p>For single-parameter priors, this field is a dictionary with the following keys</p>
<blockquote>
<div><ul>
<li><p>”prior_aux_dist”: distribution of the prior on this parameter</p></li>
<li><dl class="simple">
<dt>”prior_aux_param”: parameter of the prior on this parameter</dt><dd><ul>
<li><p>see above for admissible tags</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>For example, to specify a chi2 prior with nu=2.5, pass:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;prior_aux_dist&quot;</span><span class="p">:</span> <span class="s2">&quot;chi2&quot;</span><span class="p">,</span>

    <span class="s2">&quot;nu&quot;</span><span class="p">:</span> <span class="mf">2.5</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The default un-scaled prior is <code class="docutils literal notranslate"><span class="pre">exponential(1)</span></code>, the default scaled prior is
<code class="docutils literal notranslate"><span class="pre">exponential(1/sy)</span></code> where <code class="docutils literal notranslate"><span class="pre">sy</span> <span class="pre">=</span> <span class="pre">sd(y)</span></code> if the specified family is a Gaussian,
and <code class="docutils literal notranslate"><span class="pre">sy</span> <span class="pre">=</span> <span class="pre">1</span></code> in all other cases. Setting <code class="docutils literal notranslate"><span class="pre">autoscale=True</span></code> results in division by
sy.</p>
</p></li>
<li><p><strong>autoscale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – <p>Enable automatic scaling of priors. Autoscaling is performed the same as in <a class="reference external" href="https://cran.r-project.org/web/packages/rstanarm/vignettes/priors.html">rstanarm</a>.</p>
<p>This procedure does not happen by default.</p>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<dl class="simple">
<dt>The usual prior-selection advice holds. See these discussions about prior selection:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations">https://github.com/stan-dev/stan/wiki/Prior-Choice-Recommendations</a></p></li>
<li><p><a class="reference external" href="http://www.stat.columbia.edu/~gelman/research/published/entropy-19-00555-v2.pdf">http://www.stat.columbia.edu/~gelman/research/published/entropy-19-00555-v2.pdf</a></p></li>
</ul>
</dd>
</dl>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="scikit_stan.GLM.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_console</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scikit_stan/generalized_linear_regression/glm.html#GLM.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scikit_stan.GLM.fit" title="Permalink to this definition">#</a></dt>
<dd><p>Fits GLM model to the given data.
This model is considered fit once its alpha, beta,
and sigma parameters are determined via a regression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-array-like" title="(in scikit-learn v1.1)"><span class="xref std std-term">array-like</span></a>) – NxK matrix of predictors, where K &gt;= 0. If K = 1,
then X is automatically reshaped to being 2D and raises a warning.
X can be sparse. It will be converted to CSR format if it is not already.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-array-like" title="(in scikit-learn v1.1)"><span class="xref std std-term">array-like</span></a>) – Nx1 outcome vector where each row is a response corresponding to
the same row of predictors in X.</p></li>
<li><p><strong>show_console</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – Printing output of default CmdStanPy console during Stan operations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">CoreEstimator</span></code> – Abstract class for all estimator-type models in this package.
The GLM class is a subclass of CoreEstimator.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – X is required to have at least 2 columns and have the same number of rows as y.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – y is required to have exactly 1 column and the same number of rows as X.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – Algorithm choice in model set-up is not supported.</p></li>
</ul>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>Other ValueErrors may be raised by additional validation checks.
These include invalid prior set-up or invalid data.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scikit_stan.GLM.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_console</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scikit_stan/generalized_linear_regression/glm.html#GLM.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scikit_stan.GLM.predict" title="Permalink to this definition">#</a></dt>
<dd><dl class="simple">
<dt>Compute predictions from supplied data using a fitted model.</dt><dd><p>This computes the mean of the predicted distribution,
given by y_sim in predict_distribution().</p>
</dd>
</dl>
<p>A key issue is that predict() will not utilize Stan’s generate quantities method
if the model as not fit with HMC-NUTS. Instead, a Python-based rng is used with
coefficients and intercept derived from the fitted model. This will change in a
future Stan release.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-array-like" title="(in scikit-learn v1.1)"><span class="xref std std-term">array-like</span></a>) – Predictor matrix or array of data to use for prediction.
X can be sparse. It will be converted to CSR format if it is not already.</p></li>
<li><p><strong>return_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>, <em>default</em> <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>) – If True, return standard deviation of predictions.</p></li>
<li><p><strong>show_console</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>, <em>default</em> <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>) – Printing output of default CmdStanPy console during Stan operations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> – Array of predictions of shape (n_samples, 1) made by fitted model.</p></li>
<li><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.23)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> – Standard deviation of predictive distribution points.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scikit_stan.GLM.predict_distribution">
<span class="sig-name descname"><span class="pre">predict_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_console</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scikit_stan/generalized_linear_regression/glm.html#GLM.predict_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scikit_stan.GLM.predict_distribution" title="Permalink to this definition">#</a></dt>
<dd><p>Predicts the distribution of the response variable after model has been fit.
This is distinct from predict(), which returns the mean of distribution
predictions generated by this method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray[Union[np.float64</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.int64]]</span></code>) – Predictor matrix or array of data to use for prediction.
X can be sparse. It will be converted to CSR format if it is not already.</p></li>
<li><p><strong>show_console</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – Printing output of default CmdStanPy console during Stan operations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">NDArray[Union[np.float64</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">np.int64]]</span></code> – Set of draws generated by Stan generate quantities method.</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – Method requires data X to be supplied.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="scikit_stan.GLM.score">
<span class="sig-name descname"><span class="pre">score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_console</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/scikit_stan/generalized_linear_regression/glm.html#GLM.score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#scikit_stan.GLM.score" title="Permalink to this definition">#</a></dt>
<dd><p>Computes the coefficient of determination R2 of the prediction,
like other sklearn estimators.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-array-like" title="(in scikit-learn v1.1)"><span class="xref std std-term">array-like</span></a>) – Matrix or array of predictors having shape (n_samples, n_predictors)
that consists of test data.
X can be sparse. It will be converted to CSR format if it is not already.</p></li>
<li><p><strong>y</strong> (<a class="reference external" href="https://scikit-learn.org/stable/glossary.html#term-array-like" title="(in scikit-learn v1.1)"><span class="xref std std-term">array-like</span></a>) – Array of shape (n_samples,) containing the target values
corresponding to given test dat X.</p></li>
<li><p><strong>show_console</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>, <em>optional</em>) – Printing output of default CmdStanPy console during Stan operations.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a> –</p>
<dl class="simple">
<dt>R2 of the prediction versus the given target values.</dt><dd><p>This is the mean accuracy of self.predict(X) with respect to y</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="getting-started.html" title="previous page">
      <i class="fas fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Getting Started</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="internal_api.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">Internal API Reference</p>
  </div>
  <i class="fas fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fas fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generalized-linear-model">
   Generalized Linear Model
  </a>
 </li>
</ul>

</nav>
</div>

<div class="toc-item">
  

<div class="tocsection editthispage">
    <a href="https://github.com/WardBrian/scikit-stan/edit/main/docs/api.rst">
        <i class="fas fa-pencil-alt"></i> Edit this page
    </a>
</div>

</div>

<div class="toc-item">
  
<div class="tocsection sourcelink">
    <a href="_sources/api.rst.txt">
        <i class="fas fa-file-alt"></i> Show Source
    </a>
</div>

</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=9b1a4fa89bdd0e95b23b"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2022, Alexey Izmailov, Brian Ward.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.1.1.<br>
</p>

  </div>
  
</div>
  </footer>
  </body>
</html>