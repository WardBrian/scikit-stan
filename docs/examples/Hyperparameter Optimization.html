
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Varying Slope Model &#8212; SciKit Stan  documentation</title>
<script>
  document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
  document.documentElement.dataset.theme = localStorage.getItem("theme") || "light"
</script>

  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=92025949c220c2e29695" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=92025949c220c2e29695" rel="stylesheet">


  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />

  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">
    <div class="bd-header-announcement container-fluid" id="banner">
      

    </div>

    
    <nav class="bd-header navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="bd-header__inner container-xl">

  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">SciKit Stan  documentation</p>
  
</a>
    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="fas fa-bars"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../getting-started.html">
  Getting Started
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../api.html">
  API Reference
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../examples.html">
  Examples
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <span id="theme-switch" class="btn btn-sm btn-outline-primary navbar-btn rounded-circle">
    <a class="theme-switch" data-mode="light"><i class="fas fa-sun"></i></a>
    <a class="theme-switch" data-mode="dark"><i class="far fa-moon"></i></a>
    <a class="theme-switch" data-mode="auto"><i class="fas fa-adjust"></i></a>
</span>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="bd-container container-xl">
      <div class="bd-container__inner row">
          

<!-- Only show if we have sidebars configured, else just a small margin  -->
<div class="bd-sidebar-primary col-12 col-md-3 bd-sidebar">
  <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
  </div>
  <div class="sidebar-end-items">
  </div>
</div>


          


<div class="bd-sidebar-secondary d-none d-xl-block col-xl-2 bd-toc">
  
    
    <div class="toc-item">
      

<nav id="bd-toc-nav">
    
</nav>
    </div>
    
    <div class="toc-item">
      
    </div>
    
  
</div>


          
          
          <div class="bd-content col-12 col-md-9 col-xl-7">
              
              <article class="bd-article" role="main">
                
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scikit_stan</span> <span class="kn">import</span> <span class="n">GLM</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># type: ignore</span>

<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">expit</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">GridSearchCV</span>

<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\Users\alizm\anaconda3\envs\cmdstan\lib\site-packages\tqdm\auto.py:22: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
  from .autonotebook import tqdm as notebook_tqdm
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s1">&#39;axes.spines&#39;</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#mpl.rc(&#39;axes&#39;, facecolor=&#39;white&#39;)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;xtick&quot;</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelbottom</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rc</span><span class="p">(</span><span class="s2">&quot;ytick&quot;</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">labelleft</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>


<span class="c1"># center images</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">HTML</span>
<span class="n">HTML</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">&lt;style&gt;</span>
<span class="s2">.jp-RenderedImage, .output_png{</span>
<span class="s2">    display: table-cell;</span>
<span class="s2">    text-align: center;</span>
<span class="s2">    vertical-align: middle;</span>
<span class="s2">}</span>
<span class="s2">&lt;/style&gt;</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<style>
.jp-RenderedImage, .output_png{
    display: table-cell;
    text-align: center;
    vertical-align: middle;
}
</style></div>
</div>
<p>This package integrates with sklearn optimization algorithms to optimize hyperparameters. In particular, the space of distributions and distribution parameters, which serve as the hyperparameters of the Bayesian model, can be optimized across with grid search. What’s more, this optimization can be perfomed at a higher meta level by working with hyperpriors and tuning hyperhyperparameters. We give an example of using sk-learn’s GridSearchCV to perform hyperparameter optimization and demonstrate
how the package integrates with the rest of the sk-learn ecosystem.</p>
<div class="line-block">
<div class="line">Keeping the priors on the regression coefficients at the default autoscaled normal, we perform a grid search over 1. The error scale of the intercept’s prior distribution, represented by <span class="math notranslate nohighlight">\(\sigma_\alpha\)</span>,</div>
<div class="line">2. The error scale for the family of <span class="math notranslate nohighlight">\(y\)</span>, represented by <span class="math notranslate nohighlight">\(\sigma_y\)</span>.</div>
</div>
<p>NOTE: In principle, this problem could be a two level hyperparameter optimization problem: an optimization over the hyperparameter <span class="math notranslate nohighlight">\(\sigma_\alpha\)</span> and then an optimization over the distribution parameter for <span class="math notranslate nohighlight">\(\sigma_\alpha\)</span>. Keep it simple for now…</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import radon data</span>
<span class="c1"># based on: https://mc-stan.org/users/documentation/case-studies/radon.html</span>
<span class="n">srrs2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;srrs2.dat&quot;</span><span class="p">)</span>
<span class="n">srrs2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">srrs2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">)</span>
<span class="n">srrs_mn</span> <span class="o">=</span> <span class="n">srrs2</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">fips</span><span class="o">=</span><span class="n">srrs2</span><span class="o">.</span><span class="n">stfips</span><span class="o">*</span><span class="mi">1000</span> <span class="o">+</span> <span class="n">srrs2</span><span class="o">.</span><span class="n">cntyfips</span><span class="p">)[</span><span class="n">srrs2</span><span class="o">.</span><span class="n">state</span><span class="o">==</span><span class="s1">&#39;MN&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cty</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">()</span> <span class="o">/</span> <span class="s2">&quot;data&quot;</span> <span class="o">/</span> <span class="s2">&quot;cty.dat&quot;</span><span class="p">)</span>
<span class="n">cty_mn</span> <span class="o">=</span> <span class="n">cty</span><span class="p">[</span><span class="n">cty</span><span class="o">.</span><span class="n">st</span><span class="o">==</span><span class="s1">&#39;MN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">cty_mn</span><span class="p">[</span> <span class="s1">&#39;fips&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="n">cty_mn</span><span class="o">.</span><span class="n">stfips</span> <span class="o">+</span> <span class="n">cty_mn</span><span class="o">.</span><span class="n">ctfips</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">srrs_mn</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">cty_mn</span><span class="p">[[</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="s1">&#39;Uppm&#39;</span><span class="p">]],</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;fips&#39;</span><span class="p">)</span>
<span class="n">srrs_mn</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="s1">&#39;idnum&#39;</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">srrs_mn</span><span class="o">.</span><span class="n">Uppm</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">srrs_mn</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">srrs_mn</span><span class="o">.</span><span class="n">county</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
<span class="n">mn_counties</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">counties</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mn_counties</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">county_lookup</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mn_counties</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mn_counties</span><span class="p">))))</span>
<span class="n">county</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="p">[</span><span class="s1">&#39;county_code&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">county_lookup</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">radon</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">activity</span>
<span class="n">srrs_mn</span><span class="p">[</span><span class="s1">&#39;log_radon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_radon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">radon</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">floor_measure</span> <span class="o">=</span> <span class="n">srrs_mn</span><span class="o">.</span><span class="n">floor</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">srrs_mn</span><span class="o">.</span><span class="n">activity</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="mf">0.1</span><span class="p">))</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">bins</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;AxesSubplot:&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Hyperparameter_Optimization_9_1.png" src="../_images/examples_Hyperparameter_Optimization_9_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span> <span class="o">=</span> <span class="n">GLM</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>

<span class="n">fitted</span> <span class="o">=</span> <span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">floor_measure</span><span class="p">,</span> <span class="n">log_radon</span><span class="p">)</span>
<span class="n">xvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">srrs_mn</span><span class="o">.</span><span class="n">floor</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">srrs_mn</span><span class="o">.</span><span class="n">activity</span><span class="o">+</span><span class="mf">0.1</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xvals</span><span class="p">,</span> <span class="n">fitted</span><span class="o">.</span><span class="n">alpha_</span> <span class="o">+</span> <span class="n">fitted</span><span class="o">.</span><span class="n">beta_</span><span class="o">*</span><span class="n">xvals</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
c:\users\alizm\documents\flatironinstitute\sk-stan-regression\scikit_stan\utils\validation.py:226: UserWarning: Passed data is one-dimensional, while estimator expects it to be at at least two-dimensional.
  warnings.warn(
c:\users\alizm\documents\flatironinstitute\sk-stan-regression\scikit_stan\generalized_linear_regression\glm.py:434: UserWarning: Prior on intercept not specified. Using default prior.
                alpha ~ normal(mu(y), 2.5 * sd(y)) if Gaussian family else normal(0, 2.5)
  warnings.warn(
c:\users\alizm\documents\flatironinstitute\sk-stan-regression\scikit_stan\generalized_linear_regression\glm.py:468: UserWarning: Prior on auxiliary parameter not specified. Using default unscaled prior
                        sigma ~ exponential(1)

  warnings.warn(
20:13:27 - cmdstanpy - INFO - CmdStan start processing
chain 1 |<span class="ansi-yellow-fg">          </span>| 00:00 Status



chain 1 |<span class="ansi-yellow-fg">█▎        </span>| 00:00 Iteration:  100 / 2000 [  5%]  (Warmup)




chain 1 |<span class="ansi-yellow-fg">████      </span>| 00:00 Iteration:  700 / 2000 [ 35%]  (Warmup)


chain 1 |<span class="ansi-blue-fg">██████▎   </span>| 00:00 Iteration: 1100 / 2000 [ 55%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">███████▋  </span>| 00:02 Iteration: 1400 / 2000 [ 70%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">████████▋ </span>| 00:02 Iteration: 1600 / 2000 [ 80%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">█████████▌</span>| 00:03 Iteration: 1800 / 2000 [ 90%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">██████████</span>| 00:03 Iteration: 1900 / 2000 [ 95%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">██████████</span>| 00:04 Sampling completed
chain 2 |<span class="ansi-blue-fg">██████████</span>| 00:04 Sampling completed
chain 3 |<span class="ansi-blue-fg">██████████</span>| 00:04 Sampling completed
chain 4 |<span class="ansi-blue-fg">██████████</span>| 00:04 Sampling completed
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

20:13:31 - cmdstanpy - INFO - CmdStan done processing.
20:13:31 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x282fef64ee0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Hyperparameter_Optimization_10_5.png" src="../_images/examples_Hyperparameter_Optimization_10_5.png" />
</div>
</div>
<section id="Varying-Slope-Model">
<h1>Varying Slope Model<a class="headerlink" href="#Varying-Slope-Model" title="Permalink to this heading">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># this actually is a hyperhyperparameter optimization problem</span>
<span class="c1"># optimize over prior_aux_param, which is a hyperhyperparameter</span>
<span class="c1"># as it is the hyperparameter for the prior for sigma, which is used</span>
<span class="c1"># as a parameter in the family distribution</span>
<span class="n">glm_opt</span> <span class="o">=</span> <span class="n">GLM</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>

<span class="n">param_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;prior_aux&quot;</span> <span class="p">:</span>
            <span class="nb">list</span><span class="p">({</span>
                <span class="s2">&quot;prior_aux_dist&quot;</span><span class="p">:</span> <span class="s2">&quot;exponential&quot;</span><span class="p">,</span>

                <span class="s2">&quot;prior_aux_param&quot;</span><span class="p">:</span> <span class="n">aux_val</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">aux_val</span> <span class="ow">in</span> <span class="n">param_range</span><span class="p">)</span>
<span class="p">}</span>


<span class="n">grid_search</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">glm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">);</span>

<span class="n">searched</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">floor_measure</span><span class="p">,</span> <span class="n">log_radon</span><span class="p">);</span>


<span class="nb">print</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>

<span class="c1">#fitted = glm.fit(X=floor_measure, y=log_radon);</span>

<span class="c1">#fitted.alpha_, fitted.beta_, fitted.sigma_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
14:55:26 - cmdstanpy - INFO - CmdStan start processing
14:55:29 - cmdstanpy - INFO - CmdStan done processing.
14:55:32 - cmdstanpy - INFO - Chain [1] start processing
14:55:32 - cmdstanpy - INFO - Chain [2] start processing
14:55:32 - cmdstanpy - INFO - Chain [3] start processing
14:55:32 - cmdstanpy - INFO - Chain [4] start processing
14:55:39 - cmdstanpy - INFO - Chain [4] done processing
14:55:39 - cmdstanpy - INFO - Chain [2] done processing
14:55:39 - cmdstanpy - INFO - Chain [3] done processing
14:55:39 - cmdstanpy - INFO - Chain [1] done processing
14:55:40 - cmdstanpy - INFO - CmdStan start processing
14:55:43 - cmdstanpy - INFO - CmdStan done processing.
14:55:43 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:55:45 - cmdstanpy - INFO - Chain [1] start processing
14:55:45 - cmdstanpy - INFO - Chain [2] start processing
14:55:45 - cmdstanpy - INFO - Chain [3] start processing
14:55:45 - cmdstanpy - INFO - Chain [4] start processing
14:55:52 - cmdstanpy - INFO - Chain [1] done processing
14:55:53 - cmdstanpy - INFO - Chain [4] done processing
14:55:53 - cmdstanpy - INFO - Chain [2] done processing
14:55:53 - cmdstanpy - INFO - Chain [3] done processing
14:55:53 - cmdstanpy - INFO - CmdStan start processing
14:55:56 - cmdstanpy - INFO - CmdStan done processing.
14:55:56 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:55:58 - cmdstanpy - INFO - Chain [1] start processing
14:55:58 - cmdstanpy - INFO - Chain [2] start processing
14:55:58 - cmdstanpy - INFO - Chain [3] start processing
14:55:58 - cmdstanpy - INFO - Chain [4] start processing
14:56:06 - cmdstanpy - INFO - Chain [2] done processing
14:56:06 - cmdstanpy - INFO - Chain [3] done processing
14:56:06 - cmdstanpy - INFO - Chain [4] done processing
14:56:06 - cmdstanpy - INFO - Chain [1] done processing
14:56:07 - cmdstanpy - INFO - CmdStan start processing
14:56:09 - cmdstanpy - INFO - CmdStan done processing.
14:56:12 - cmdstanpy - INFO - Chain [1] start processing
14:56:12 - cmdstanpy - INFO - Chain [2] start processing
14:56:12 - cmdstanpy - INFO - Chain [3] start processing
14:56:12 - cmdstanpy - INFO - Chain [4] start processing
14:56:19 - cmdstanpy - INFO - Chain [4] done processing
14:56:19 - cmdstanpy - INFO - Chain [3] done processing
14:56:19 - cmdstanpy - INFO - Chain [2] done processing
14:56:19 - cmdstanpy - INFO - Chain [1] done processing
14:56:20 - cmdstanpy - INFO - CmdStan start processing
14:56:23 - cmdstanpy - INFO - CmdStan done processing.
14:56:23 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:56:25 - cmdstanpy - INFO - Chain [1] start processing
14:56:25 - cmdstanpy - INFO - Chain [2] start processing
14:56:25 - cmdstanpy - INFO - Chain [3] start processing
14:56:25 - cmdstanpy - INFO - Chain [4] start processing
14:56:32 - cmdstanpy - INFO - Chain [4] done processing
14:56:32 - cmdstanpy - INFO - Chain [2] done processing
14:56:32 - cmdstanpy - INFO - Chain [1] done processing
14:56:32 - cmdstanpy - INFO - Chain [3] done processing
14:56:33 - cmdstanpy - INFO - CmdStan start processing
14:56:36 - cmdstanpy - INFO - CmdStan done processing.
14:56:36 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:56:38 - cmdstanpy - INFO - Chain [1] start processing
14:56:38 - cmdstanpy - INFO - Chain [2] start processing
14:56:38 - cmdstanpy - INFO - Chain [3] start processing
14:56:38 - cmdstanpy - INFO - Chain [4] start processing
14:56:45 - cmdstanpy - INFO - Chain [3] done processing
14:56:45 - cmdstanpy - INFO - Chain [1] done processing
14:56:45 - cmdstanpy - INFO - Chain [4] done processing
14:56:45 - cmdstanpy - INFO - Chain [2] done processing
14:56:46 - cmdstanpy - INFO - CmdStan start processing
14:56:48 - cmdstanpy - INFO - CmdStan done processing.
14:56:48 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:56:51 - cmdstanpy - INFO - Chain [1] start processing
14:56:51 - cmdstanpy - INFO - Chain [2] start processing
14:56:51 - cmdstanpy - INFO - Chain [3] start processing
14:56:51 - cmdstanpy - INFO - Chain [4] start processing
14:56:58 - cmdstanpy - INFO - Chain [1] done processing
14:56:58 - cmdstanpy - INFO - Chain [3] done processing
14:56:58 - cmdstanpy - INFO - Chain [2] done processing
14:56:59 - cmdstanpy - INFO - Chain [4] done processing
14:56:59 - cmdstanpy - INFO - CmdStan start processing
14:57:02 - cmdstanpy - INFO - CmdStan done processing.
14:57:02 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:57:04 - cmdstanpy - INFO - Chain [1] start processing
14:57:04 - cmdstanpy - INFO - Chain [2] start processing
14:57:04 - cmdstanpy - INFO - Chain [3] start processing
14:57:04 - cmdstanpy - INFO - Chain [4] start processing
14:57:11 - cmdstanpy - INFO - Chain [4] done processing
14:57:11 - cmdstanpy - INFO - Chain [2] done processing
14:57:12 - cmdstanpy - INFO - Chain [1] done processing
14:57:12 - cmdstanpy - INFO - Chain [3] done processing
14:57:12 - cmdstanpy - INFO - CmdStan start processing
14:57:15 - cmdstanpy - INFO - CmdStan done processing.
14:57:15 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:57:17 - cmdstanpy - INFO - Chain [1] start processing
14:57:17 - cmdstanpy - INFO - Chain [2] start processing
14:57:17 - cmdstanpy - INFO - Chain [3] start processing
14:57:17 - cmdstanpy - INFO - Chain [4] start processing
14:57:24 - cmdstanpy - INFO - Chain [1] done processing
14:57:24 - cmdstanpy - INFO - Chain [4] done processing
14:57:24 - cmdstanpy - INFO - Chain [3] done processing
14:57:24 - cmdstanpy - INFO - Chain [2] done processing
14:57:25 - cmdstanpy - INFO - CmdStan start processing
14:57:28 - cmdstanpy - INFO - CmdStan done processing.
14:57:28 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:57:30 - cmdstanpy - INFO - Chain [1] start processing
14:57:30 - cmdstanpy - INFO - Chain [2] start processing
14:57:30 - cmdstanpy - INFO - Chain [3] start processing
14:57:30 - cmdstanpy - INFO - Chain [4] start processing
14:57:38 - cmdstanpy - INFO - Chain [3] done processing
14:57:38 - cmdstanpy - INFO - Chain [1] done processing
14:57:38 - cmdstanpy - INFO - Chain [4] done processing
14:57:38 - cmdstanpy - INFO - Chain [2] done processing
14:57:38 - cmdstanpy - INFO - CmdStan start processing
14:57:41 - cmdstanpy - INFO - CmdStan done processing.
14:57:41 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:57:43 - cmdstanpy - INFO - Chain [1] start processing
14:57:43 - cmdstanpy - INFO - Chain [2] start processing
14:57:43 - cmdstanpy - INFO - Chain [3] start processing
14:57:43 - cmdstanpy - INFO - Chain [4] start processing
14:57:51 - cmdstanpy - INFO - Chain [1] done processing
14:57:51 - cmdstanpy - INFO - Chain [4] done processing
14:57:51 - cmdstanpy - INFO - Chain [2] done processing
14:57:51 - cmdstanpy - INFO - Chain [3] done processing
14:57:52 - cmdstanpy - INFO - CmdStan start processing
14:57:54 - cmdstanpy - INFO - CmdStan done processing.
14:57:54 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:57:57 - cmdstanpy - INFO - Chain [1] start processing
14:57:57 - cmdstanpy - INFO - Chain [2] start processing
14:57:57 - cmdstanpy - INFO - Chain [3] start processing
14:57:57 - cmdstanpy - INFO - Chain [4] start processing
14:58:05 - cmdstanpy - INFO - Chain [2] done processing
14:58:05 - cmdstanpy - INFO - Chain [1] done processing
14:58:05 - cmdstanpy - INFO - Chain [4] done processing
14:58:05 - cmdstanpy - INFO - Chain [3] done processing
14:58:05 - cmdstanpy - INFO - CmdStan start processing
14:58:09 - cmdstanpy - INFO - CmdStan done processing.
14:58:09 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:58:11 - cmdstanpy - INFO - Chain [1] start processing
14:58:11 - cmdstanpy - INFO - Chain [2] start processing
14:58:11 - cmdstanpy - INFO - Chain [3] start processing
14:58:11 - cmdstanpy - INFO - Chain [4] start processing
14:58:20 - cmdstanpy - INFO - Chain [1] done processing
14:58:20 - cmdstanpy - INFO - Chain [3] done processing
14:58:20 - cmdstanpy - INFO - Chain [2] done processing
14:58:20 - cmdstanpy - INFO - Chain [4] done processing
14:58:21 - cmdstanpy - INFO - CmdStan start processing
14:58:24 - cmdstanpy - INFO - CmdStan done processing.
14:58:27 - cmdstanpy - INFO - Chain [1] start processing
14:58:27 - cmdstanpy - INFO - Chain [2] start processing
14:58:27 - cmdstanpy - INFO - Chain [3] start processing
14:58:27 - cmdstanpy - INFO - Chain [4] start processing
14:58:38 - cmdstanpy - INFO - Chain [2] done processing
14:58:38 - cmdstanpy - INFO - Chain [1] done processing
14:58:38 - cmdstanpy - INFO - Chain [3] done processing
14:58:39 - cmdstanpy - INFO - Chain [4] done processing
14:58:39 - cmdstanpy - INFO - CmdStan start processing
14:58:42 - cmdstanpy - INFO - CmdStan done processing.
14:58:42 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:58:44 - cmdstanpy - INFO - Chain [1] start processing
14:58:44 - cmdstanpy - INFO - Chain [2] start processing
14:58:44 - cmdstanpy - INFO - Chain [3] start processing
14:58:44 - cmdstanpy - INFO - Chain [4] start processing
14:58:52 - cmdstanpy - INFO - Chain [2] done processing
14:58:52 - cmdstanpy - INFO - Chain [3] done processing
14:58:52 - cmdstanpy - INFO - Chain [1] done processing
14:58:52 - cmdstanpy - INFO - Chain [4] done processing
14:58:53 - cmdstanpy - INFO - CmdStan start processing
14:58:55 - cmdstanpy - INFO - CmdStan done processing.
14:58:55 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:58:58 - cmdstanpy - INFO - Chain [1] start processing
14:58:58 - cmdstanpy - INFO - Chain [2] start processing
14:58:58 - cmdstanpy - INFO - Chain [3] start processing
14:58:58 - cmdstanpy - INFO - Chain [4] start processing
14:59:06 - cmdstanpy - INFO - Chain [1] done processing
14:59:06 - cmdstanpy - INFO - Chain [3] done processing
14:59:06 - cmdstanpy - INFO - Chain [2] done processing
14:59:06 - cmdstanpy - INFO - Chain [4] done processing
14:59:06 - cmdstanpy - INFO - CmdStan start processing
14:59:09 - cmdstanpy - INFO - CmdStan done processing.
14:59:09 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
14:59:11 - cmdstanpy - INFO - Chain [1] start processing
14:59:11 - cmdstanpy - INFO - Chain [2] start processing
14:59:11 - cmdstanpy - INFO - Chain [3] start processing
14:59:11 - cmdstanpy - INFO - Chain [4] start processing
14:59:18 - cmdstanpy - INFO - Chain [1] done processing
14:59:19 - cmdstanpy - INFO - Chain [2] done processing
14:59:19 - cmdstanpy - INFO - Chain [4] done processing
14:59:19 - cmdstanpy - INFO - Chain [3] done processing
14:59:19 - cmdstanpy - INFO - CmdStan start processing
14:59:22 - cmdstanpy - INFO - CmdStan done processing.
14:59:24 - cmdstanpy - INFO - Chain [1] start processing
14:59:24 - cmdstanpy - INFO - Chain [2] start processing
14:59:24 - cmdstanpy - INFO - Chain [3] start processing
14:59:24 - cmdstanpy - INFO - Chain [4] start processing
14:59:31 - cmdstanpy - INFO - Chain [3] done processing
14:59:31 - cmdstanpy - INFO - Chain [4] done processing
14:59:31 - cmdstanpy - INFO - Chain [2] done processing
14:59:31 - cmdstanpy - INFO - Chain [1] done processing
14:59:32 - cmdstanpy - INFO - CmdStan start processing
14:59:34 - cmdstanpy - INFO - CmdStan done processing.
14:59:37 - cmdstanpy - INFO - Chain [1] start processing
14:59:37 - cmdstanpy - INFO - Chain [2] start processing
14:59:37 - cmdstanpy - INFO - Chain [3] start processing
14:59:37 - cmdstanpy - INFO - Chain [4] start processing
14:59:44 - cmdstanpy - INFO - Chain [1] done processing
14:59:44 - cmdstanpy - INFO - Chain [3] done processing
14:59:44 - cmdstanpy - INFO - Chain [2] done processing
14:59:44 - cmdstanpy - INFO - Chain [4] done processing
14:59:45 - cmdstanpy - INFO - CmdStan start processing
14:59:47 - cmdstanpy - INFO - CmdStan done processing.
14:59:50 - cmdstanpy - INFO - Chain [1] start processing
14:59:50 - cmdstanpy - INFO - Chain [2] start processing
14:59:50 - cmdstanpy - INFO - Chain [3] start processing
14:59:50 - cmdstanpy - INFO - Chain [4] start processing
14:59:57 - cmdstanpy - INFO - Chain [3] done processing
14:59:57 - cmdstanpy - INFO - Chain [1] done processing
14:59:57 - cmdstanpy - INFO - Chain [2] done processing
14:59:57 - cmdstanpy - INFO - Chain [4] done processing
14:59:57 - cmdstanpy - INFO - CmdStan start processing
15:00:00 - cmdstanpy - INFO - CmdStan done processing.
15:00:00 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
15:00:03 - cmdstanpy - INFO - Chain [1] start processing
15:00:03 - cmdstanpy - INFO - Chain [2] start processing
15:00:03 - cmdstanpy - INFO - Chain [3] start processing
15:00:03 - cmdstanpy - INFO - Chain [4] start processing
15:00:10 - cmdstanpy - INFO - Chain [4] done processing
15:00:10 - cmdstanpy - INFO - Chain [1] done processing
15:00:10 - cmdstanpy - INFO - Chain [3] done processing
15:00:10 - cmdstanpy - INFO - Chain [2] done processing
15:00:11 - cmdstanpy - INFO - CmdStan start processing
15:00:13 - cmdstanpy - INFO - CmdStan done processing.
15:00:13 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
15:00:16 - cmdstanpy - INFO - Chain [1] start processing
15:00:16 - cmdstanpy - INFO - Chain [2] start processing
15:00:16 - cmdstanpy - INFO - Chain [3] start processing
15:00:16 - cmdstanpy - INFO - Chain [4] start processing
15:00:23 - cmdstanpy - INFO - Chain [1] done processing
15:00:23 - cmdstanpy - INFO - Chain [4] done processing
15:00:23 - cmdstanpy - INFO - Chain [2] done processing
15:00:24 - cmdstanpy - INFO - Chain [3] done processing
15:00:24 - cmdstanpy - INFO - CmdStan start processing
15:00:27 - cmdstanpy - INFO - CmdStan done processing.
15:00:27 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
15:00:29 - cmdstanpy - INFO - Chain [1] start processing
15:00:29 - cmdstanpy - INFO - Chain [2] start processing
15:00:29 - cmdstanpy - INFO - Chain [3] start processing
15:00:29 - cmdstanpy - INFO - Chain [4] start processing
15:00:37 - cmdstanpy - INFO - Chain [3] done processing
15:00:37 - cmdstanpy - INFO - Chain [4] done processing
15:00:37 - cmdstanpy - INFO - Chain [2] done processing
15:00:37 - cmdstanpy - INFO - Chain [1] done processing
15:00:37 - cmdstanpy - INFO - CmdStan start processing
15:00:40 - cmdstanpy - INFO - CmdStan done processing.
15:00:40 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
15:00:42 - cmdstanpy - INFO - Chain [1] start processing
15:00:42 - cmdstanpy - INFO - Chain [2] start processing
15:00:42 - cmdstanpy - INFO - Chain [3] start processing
15:00:42 - cmdstanpy - INFO - Chain [4] start processing
15:00:50 - cmdstanpy - INFO - Chain [4] done processing
15:00:50 - cmdstanpy - INFO - Chain [2] done processing
15:00:50 - cmdstanpy - INFO - Chain [3] done processing
15:00:50 - cmdstanpy - INFO - Chain [1] done processing
15:00:50 - cmdstanpy - INFO - CmdStan start processing
15:00:53 - cmdstanpy - INFO - CmdStan done processing.
15:00:53 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
15:00:55 - cmdstanpy - INFO - Chain [1] start processing
15:00:55 - cmdstanpy - INFO - Chain [2] start processing
15:00:55 - cmdstanpy - INFO - Chain [3] start processing
15:00:55 - cmdstanpy - INFO - Chain [4] start processing
15:01:03 - cmdstanpy - INFO - Chain [1] done processing
15:01:03 - cmdstanpy - INFO - Chain [3] done processing
15:01:03 - cmdstanpy - INFO - Chain [4] done processing
15:01:03 - cmdstanpy - INFO - Chain [2] done processing
15:01:04 - cmdstanpy - INFO - CmdStan start processing
15:01:07 - cmdstanpy - INFO - CmdStan done processing.
15:01:07 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>
<span class="c1"># this actually is a hyperhyperparameter optimization problem</span>
<span class="c1"># optimize over prior_aux_param, which is a hyperhyperparameter</span>
<span class="c1"># as it is the hyperparameter for the prior for sigma, which is used</span>
<span class="c1"># as a parameter in the family distribution</span>
<span class="n">glm_opt2</span> <span class="o">=</span> <span class="n">GLM</span><span class="p">(</span><span class="n">family</span><span class="o">=</span><span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="n">link</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="p">)</span>

<span class="n">param_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;prior_intercept&quot;</span> <span class="p">:</span>
            <span class="nb">list</span><span class="p">({</span>
                <span class="s2">&quot;prior_intercept_dist&quot;</span><span class="p">:</span> <span class="s2">&quot;normal&quot;</span><span class="p">,</span>

                <span class="s2">&quot;prior_intercept_mu&quot;</span><span class="p">:</span> <span class="mf">1.5</span><span class="p">,</span>

                <span class="s2">&quot;prior_intercept_sigma&quot;</span><span class="p">:</span> <span class="n">sigma_alpha_val</span>
            <span class="p">}</span>
            <span class="k">for</span> <span class="n">sigma_alpha_val</span> <span class="ow">in</span> <span class="n">param_range</span><span class="p">)</span>
<span class="p">}</span>


<span class="n">grid_search2</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">glm</span><span class="p">,</span> <span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">);</span>

<span class="n">searched</span> <span class="o">=</span> <span class="n">grid_search2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">floor_measure</span><span class="p">,</span> <span class="n">log_radon</span><span class="p">);</span>


<span class="nb">print</span><span class="p">(</span><span class="n">grid_search</span><span class="o">.</span><span class="n">cv_results_</span><span class="p">)</span>

<span class="c1">#fitted = glm.fit(X=floor_measure, y=log_radon);</span>

<span class="c1">#fitted.alpha_, fitted.beta_, fitted.sigma_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
16:09:32 - cmdstanpy - INFO - CmdStan start processing
16:09:35 - cmdstanpy - INFO - CmdStan done processing.
16:09:35 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:09:37 - cmdstanpy - INFO - Chain [1] start processing
16:09:37 - cmdstanpy - INFO - Chain [2] start processing
16:09:37 - cmdstanpy - INFO - Chain [3] start processing
16:09:37 - cmdstanpy - INFO - Chain [4] start processing
16:09:46 - cmdstanpy - INFO - Chain [4] done processing
16:09:46 - cmdstanpy - INFO - Chain [2] done processing
16:09:46 - cmdstanpy - INFO - Chain [3] done processing
16:09:46 - cmdstanpy - INFO - Chain [1] done processing
16:09:47 - cmdstanpy - INFO - CmdStan start processing
16:09:50 - cmdstanpy - INFO - CmdStan done processing.
16:09:50 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:09:52 - cmdstanpy - INFO - Chain [1] start processing
16:09:52 - cmdstanpy - INFO - Chain [2] start processing
16:09:52 - cmdstanpy - INFO - Chain [3] start processing
16:09:52 - cmdstanpy - INFO - Chain [4] start processing
16:10:01 - cmdstanpy - INFO - Chain [1] done processing
16:10:01 - cmdstanpy - INFO - Chain [3] done processing
16:10:01 - cmdstanpy - INFO - Chain [4] done processing
16:10:01 - cmdstanpy - INFO - Chain [2] done processing
16:10:01 - cmdstanpy - INFO - CmdStan start processing
16:10:04 - cmdstanpy - INFO - CmdStan done processing.
16:10:04 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:10:07 - cmdstanpy - INFO - Chain [1] start processing
16:10:07 - cmdstanpy - INFO - Chain [2] start processing
16:10:07 - cmdstanpy - INFO - Chain [3] start processing
16:10:07 - cmdstanpy - INFO - Chain [4] start processing
16:10:18 - cmdstanpy - INFO - Chain [2] done processing
16:10:18 - cmdstanpy - INFO - Chain [1] done processing
16:10:18 - cmdstanpy - INFO - Chain [3] done processing
16:10:18 - cmdstanpy - INFO - Chain [4] done processing
16:10:18 - cmdstanpy - INFO - CmdStan start processing
16:10:22 - cmdstanpy - INFO - CmdStan done processing.
16:10:24 - cmdstanpy - INFO - Chain [1] start processing
16:10:24 - cmdstanpy - INFO - Chain [2] start processing
16:10:24 - cmdstanpy - INFO - Chain [3] start processing
16:10:24 - cmdstanpy - INFO - Chain [4] start processing
16:10:32 - cmdstanpy - INFO - Chain [2] done processing
16:10:32 - cmdstanpy - INFO - Chain [4] done processing
16:10:32 - cmdstanpy - INFO - Chain [3] done processing
16:10:32 - cmdstanpy - INFO - Chain [1] done processing
16:10:33 - cmdstanpy - INFO - CmdStan start processing
16:10:36 - cmdstanpy - INFO - CmdStan done processing.
16:10:36 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:10:39 - cmdstanpy - INFO - Chain [1] start processing
16:10:39 - cmdstanpy - INFO - Chain [2] start processing
16:10:39 - cmdstanpy - INFO - Chain [3] start processing
16:10:39 - cmdstanpy - INFO - Chain [4] start processing
16:10:47 - cmdstanpy - INFO - Chain [1] done processing
16:10:47 - cmdstanpy - INFO - Chain [2] done processing
16:10:47 - cmdstanpy - INFO - Chain [4] done processing
16:10:47 - cmdstanpy - INFO - Chain [3] done processing
16:10:47 - cmdstanpy - INFO - CmdStan start processing
16:10:50 - cmdstanpy - INFO - CmdStan done processing.
16:10:53 - cmdstanpy - INFO - Chain [1] start processing
16:10:53 - cmdstanpy - INFO - Chain [2] start processing
16:10:53 - cmdstanpy - INFO - Chain [3] start processing
16:10:53 - cmdstanpy - INFO - Chain [4] start processing
16:11:01 - cmdstanpy - INFO - Chain [4] done processing
16:11:01 - cmdstanpy - INFO - Chain [2] done processing
16:11:01 - cmdstanpy - INFO - Chain [1] done processing
16:11:01 - cmdstanpy - INFO - Chain [3] done processing
16:11:01 - cmdstanpy - INFO - CmdStan start processing
16:11:04 - cmdstanpy - INFO - CmdStan done processing.
16:11:04 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:11:07 - cmdstanpy - INFO - Chain [1] start processing
16:11:07 - cmdstanpy - INFO - Chain [2] start processing
16:11:07 - cmdstanpy - INFO - Chain [3] start processing
16:11:07 - cmdstanpy - INFO - Chain [4] start processing
16:11:15 - cmdstanpy - INFO - Chain [4] done processing
16:11:15 - cmdstanpy - INFO - Chain [3] done processing
16:11:15 - cmdstanpy - INFO - Chain [1] done processing
16:11:15 - cmdstanpy - INFO - Chain [2] done processing
16:11:16 - cmdstanpy - INFO - CmdStan start processing
16:11:18 - cmdstanpy - INFO - CmdStan done processing.
16:11:18 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:11:21 - cmdstanpy - INFO - Chain [1] start processing
16:11:21 - cmdstanpy - INFO - Chain [2] start processing
16:11:21 - cmdstanpy - INFO - Chain [3] start processing
16:11:21 - cmdstanpy - INFO - Chain [4] start processing
16:11:28 - cmdstanpy - INFO - Chain [1] done processing
16:11:28 - cmdstanpy - INFO - Chain [2] done processing
16:11:28 - cmdstanpy - INFO - Chain [4] done processing
16:11:28 - cmdstanpy - INFO - Chain [3] done processing
16:11:29 - cmdstanpy - INFO - CmdStan start processing
16:11:31 - cmdstanpy - INFO - CmdStan done processing.
16:11:31 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:11:34 - cmdstanpy - INFO - Chain [1] start processing
16:11:34 - cmdstanpy - INFO - Chain [2] start processing
16:11:34 - cmdstanpy - INFO - Chain [3] start processing
16:11:34 - cmdstanpy - INFO - Chain [4] start processing
16:11:41 - cmdstanpy - INFO - Chain [1] done processing
16:11:41 - cmdstanpy - INFO - Chain [3] done processing
16:11:41 - cmdstanpy - INFO - Chain [2] done processing
16:11:41 - cmdstanpy - INFO - Chain [4] done processing
16:11:42 - cmdstanpy - INFO - CmdStan start processing
16:11:45 - cmdstanpy - INFO - CmdStan done processing.
16:11:45 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:11:47 - cmdstanpy - INFO - Chain [1] start processing
16:11:47 - cmdstanpy - INFO - Chain [2] start processing
16:11:47 - cmdstanpy - INFO - Chain [3] start processing
16:11:47 - cmdstanpy - INFO - Chain [4] start processing
16:11:55 - cmdstanpy - INFO - Chain [3] done processing
16:11:55 - cmdstanpy - INFO - Chain [1] done processing
16:11:55 - cmdstanpy - INFO - Chain [4] done processing
16:11:55 - cmdstanpy - INFO - Chain [2] done processing
16:11:55 - cmdstanpy - INFO - CmdStan start processing
16:11:58 - cmdstanpy - INFO - CmdStan done processing.
16:11:58 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:12:01 - cmdstanpy - INFO - Chain [1] start processing
16:12:01 - cmdstanpy - INFO - Chain [2] start processing
16:12:01 - cmdstanpy - INFO - Chain [3] start processing
16:12:01 - cmdstanpy - INFO - Chain [4] start processing
16:12:08 - cmdstanpy - INFO - Chain [2] done processing
16:12:08 - cmdstanpy - INFO - Chain [1] done processing
16:12:08 - cmdstanpy - INFO - Chain [3] done processing
16:12:08 - cmdstanpy - INFO - Chain [4] done processing
16:12:08 - cmdstanpy - INFO - CmdStan start processing
16:12:12 - cmdstanpy - INFO - CmdStan done processing.
16:12:12 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:12:14 - cmdstanpy - INFO - Chain [1] start processing
16:12:14 - cmdstanpy - INFO - Chain [2] start processing
16:12:14 - cmdstanpy - INFO - Chain [3] start processing
16:12:14 - cmdstanpy - INFO - Chain [4] start processing
16:12:23 - cmdstanpy - INFO - Chain [1] done processing
16:12:23 - cmdstanpy - INFO - Chain [2] done processing
16:12:23 - cmdstanpy - INFO - Chain [3] done processing
16:12:23 - cmdstanpy - INFO - Chain [4] done processing
16:12:23 - cmdstanpy - INFO - CmdStan start processing
16:12:26 - cmdstanpy - INFO - CmdStan done processing.
16:12:26 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:12:29 - cmdstanpy - INFO - Chain [1] start processing
16:12:29 - cmdstanpy - INFO - Chain [2] start processing
16:12:29 - cmdstanpy - INFO - Chain [3] start processing
16:12:29 - cmdstanpy - INFO - Chain [4] start processing
16:12:37 - cmdstanpy - INFO - Chain [4] done processing
16:12:37 - cmdstanpy - INFO - Chain [2] done processing
16:12:37 - cmdstanpy - INFO - Chain [3] done processing
16:12:37 - cmdstanpy - INFO - Chain [1] done processing
16:12:37 - cmdstanpy - INFO - CmdStan start processing
16:12:41 - cmdstanpy - INFO - CmdStan done processing.
16:12:41 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:12:44 - cmdstanpy - INFO - Chain [1] start processing
16:12:44 - cmdstanpy - INFO - Chain [2] start processing
16:12:44 - cmdstanpy - INFO - Chain [3] start processing
16:12:44 - cmdstanpy - INFO - Chain [4] start processing
16:12:52 - cmdstanpy - INFO - Chain [2] done processing
16:12:52 - cmdstanpy - INFO - Chain [3] done processing
16:12:52 - cmdstanpy - INFO - Chain [4] done processing
16:12:52 - cmdstanpy - INFO - Chain [1] done processing
16:12:52 - cmdstanpy - INFO - CmdStan start processing
16:12:56 - cmdstanpy - INFO - CmdStan done processing.
16:12:56 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:12:58 - cmdstanpy - INFO - Chain [1] start processing
16:12:58 - cmdstanpy - INFO - Chain [2] start processing
16:12:58 - cmdstanpy - INFO - Chain [3] start processing
16:12:58 - cmdstanpy - INFO - Chain [4] start processing
16:13:06 - cmdstanpy - INFO - Chain [4] done processing
16:13:06 - cmdstanpy - INFO - Chain [1] done processing
16:13:06 - cmdstanpy - INFO - Chain [2] done processing
16:13:06 - cmdstanpy - INFO - Chain [3] done processing
16:13:06 - cmdstanpy - INFO - CmdStan start processing
16:13:09 - cmdstanpy - INFO - CmdStan done processing.
16:13:09 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:13:12 - cmdstanpy - INFO - Chain [1] start processing
16:13:12 - cmdstanpy - INFO - Chain [2] start processing
16:13:12 - cmdstanpy - INFO - Chain [3] start processing
16:13:12 - cmdstanpy - INFO - Chain [4] start processing
16:13:19 - cmdstanpy - INFO - Chain [1] done processing
16:13:19 - cmdstanpy - INFO - Chain [4] done processing
16:13:19 - cmdstanpy - INFO - Chain [2] done processing
16:13:19 - cmdstanpy - INFO - Chain [3] done processing
16:13:20 - cmdstanpy - INFO - CmdStan start processing
16:13:23 - cmdstanpy - INFO - CmdStan done processing.
16:13:25 - cmdstanpy - INFO - Chain [1] start processing
16:13:25 - cmdstanpy - INFO - Chain [2] start processing
16:13:25 - cmdstanpy - INFO - Chain [3] start processing
16:13:25 - cmdstanpy - INFO - Chain [4] start processing
16:13:33 - cmdstanpy - INFO - Chain [1] done processing
16:13:33 - cmdstanpy - INFO - Chain [3] done processing
16:13:33 - cmdstanpy - INFO - Chain [2] done processing
16:13:33 - cmdstanpy - INFO - Chain [4] done processing
16:13:34 - cmdstanpy - INFO - CmdStan start processing
16:13:37 - cmdstanpy - INFO - CmdStan done processing.
16:13:37 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:13:39 - cmdstanpy - INFO - Chain [1] start processing
16:13:39 - cmdstanpy - INFO - Chain [2] start processing
16:13:39 - cmdstanpy - INFO - Chain [3] start processing
16:13:39 - cmdstanpy - INFO - Chain [4] start processing
16:13:48 - cmdstanpy - INFO - Chain [3] done processing
16:13:48 - cmdstanpy - INFO - Chain [2] done processing
16:13:48 - cmdstanpy - INFO - Chain [4] done processing
16:13:48 - cmdstanpy - INFO - Chain [1] done processing
16:13:49 - cmdstanpy - INFO - CmdStan start processing
16:13:51 - cmdstanpy - INFO - CmdStan done processing.
16:13:51 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:13:54 - cmdstanpy - INFO - Chain [1] start processing
16:13:54 - cmdstanpy - INFO - Chain [2] start processing
16:13:54 - cmdstanpy - INFO - Chain [3] start processing
16:13:54 - cmdstanpy - INFO - Chain [4] start processing
16:14:02 - cmdstanpy - INFO - Chain [2] done processing
16:14:02 - cmdstanpy - INFO - Chain [3] done processing
16:14:02 - cmdstanpy - INFO - Chain [4] done processing
16:14:02 - cmdstanpy - INFO - Chain [1] done processing
16:14:03 - cmdstanpy - INFO - CmdStan start processing
16:14:06 - cmdstanpy - INFO - CmdStan done processing.
16:14:06 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:14:08 - cmdstanpy - INFO - Chain [1] start processing
16:14:08 - cmdstanpy - INFO - Chain [2] start processing
16:14:08 - cmdstanpy - INFO - Chain [3] start processing
16:14:08 - cmdstanpy - INFO - Chain [4] start processing
16:14:16 - cmdstanpy - INFO - Chain [1] done processing
16:14:16 - cmdstanpy - INFO - Chain [3] done processing
16:14:16 - cmdstanpy - INFO - Chain [4] done processing
16:14:16 - cmdstanpy - INFO - Chain [2] done processing
16:14:17 - cmdstanpy - INFO - CmdStan start processing
16:14:20 - cmdstanpy - INFO - CmdStan done processing.
16:14:20 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:14:22 - cmdstanpy - INFO - Chain [1] start processing
16:14:22 - cmdstanpy - INFO - Chain [2] start processing
16:14:22 - cmdstanpy - INFO - Chain [3] start processing
16:14:22 - cmdstanpy - INFO - Chain [4] start processing
16:14:31 - cmdstanpy - INFO - Chain [3] done processing
16:14:31 - cmdstanpy - INFO - Chain [1] done processing
16:14:31 - cmdstanpy - INFO - Chain [2] done processing
16:14:31 - cmdstanpy - INFO - Chain [4] done processing
16:14:31 - cmdstanpy - INFO - CmdStan start processing
16:14:34 - cmdstanpy - INFO - CmdStan done processing.
16:14:34 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:14:37 - cmdstanpy - INFO - Chain [1] start processing
16:14:37 - cmdstanpy - INFO - Chain [2] start processing
16:14:37 - cmdstanpy - INFO - Chain [3] start processing
16:14:37 - cmdstanpy - INFO - Chain [4] start processing
16:14:45 - cmdstanpy - INFO - Chain [3] done processing
16:14:45 - cmdstanpy - INFO - Chain [2] done processing
16:14:45 - cmdstanpy - INFO - Chain [1] done processing
16:14:45 - cmdstanpy - INFO - Chain [4] done processing
16:14:45 - cmdstanpy - INFO - CmdStan start processing
16:14:48 - cmdstanpy - INFO - CmdStan done processing.
16:14:48 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:14:51 - cmdstanpy - INFO - Chain [1] start processing
16:14:51 - cmdstanpy - INFO - Chain [2] start processing
16:14:51 - cmdstanpy - INFO - Chain [3] start processing
16:14:51 - cmdstanpy - INFO - Chain [4] start processing
16:14:58 - cmdstanpy - INFO - Chain [2] done processing
16:14:58 - cmdstanpy - INFO - Chain [3] done processing
16:14:58 - cmdstanpy - INFO - Chain [1] done processing
16:14:58 - cmdstanpy - INFO - Chain [4] done processing
16:14:59 - cmdstanpy - INFO - CmdStan start processing
16:15:02 - cmdstanpy - INFO - CmdStan done processing.
16:15:04 - cmdstanpy - INFO - Chain [1] start processing
16:15:04 - cmdstanpy - INFO - Chain [2] start processing
16:15:04 - cmdstanpy - INFO - Chain [3] start processing
16:15:04 - cmdstanpy - INFO - Chain [4] start processing
16:15:12 - cmdstanpy - INFO - Chain [3] done processing
16:15:12 - cmdstanpy - INFO - Chain [1] done processing
16:15:12 - cmdstanpy - INFO - Chain [4] done processing
16:15:12 - cmdstanpy - INFO - Chain [2] done processing
16:15:12 - cmdstanpy - INFO - CmdStan start processing
16:15:15 - cmdstanpy - INFO - CmdStan done processing.
16:15:15 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
16:15:18 - cmdstanpy - INFO - Chain [1] start processing
16:15:18 - cmdstanpy - INFO - Chain [2] start processing
16:15:18 - cmdstanpy - INFO - Chain [3] start processing
16:15:18 - cmdstanpy - INFO - Chain [4] start processing
16:15:25 - cmdstanpy - INFO - Chain [4] done processing
16:15:26 - cmdstanpy - INFO - Chain [2] done processing
16:15:26 - cmdstanpy - INFO - Chain [1] done processing
16:15:26 - cmdstanpy - INFO - Chain [3] done processing
16:15:26 - cmdstanpy - INFO - CmdStan start processing
16:15:30 - cmdstanpy - INFO - CmdStan done processing.
16:15:30 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/sk_stan_regression/stan_files/glm_v_continuous.stan&#39;, line 74, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_rez2</span> <span class="o">=</span> <span class="n">grid_search2</span><span class="o">.</span><span class="n">cv_results_</span>
<span class="n">gs_rez2</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;mean_fit_time&#39;: array([5.63911018, 5.37399569, 5.77570066, 5.56180911, 5.52767596]),
 &#39;std_fit_time&#39;: array([0.16018198, 0.21030081, 0.39853522, 0.17529649, 0.19464907]),
 &#39;mean_score_time&#39;: array([9.43437424, 8.24959178, 8.43530154, 8.50664806, 8.31223288]),
 &#39;std_score_time&#39;: array([1.1753259 , 0.3028564 , 0.42739206, 0.4264129 , 0.34747   ]),
 &#39;param_prior_intercept&#39;: masked_array(data=[{&#39;prior_intercept_dist&#39;: &#39;normal&#39;, &#39;prior_intercept_mu&#39;: 1.5, &#39;prior_intercept_sigma&#39;: 0.1},
                    {&#39;prior_intercept_dist&#39;: &#39;normal&#39;, &#39;prior_intercept_mu&#39;: 1.5, &#39;prior_intercept_sigma&#39;: 0.2},
                    {&#39;prior_intercept_dist&#39;: &#39;normal&#39;, &#39;prior_intercept_mu&#39;: 1.5, &#39;prior_intercept_sigma&#39;: 0.30000000000000004},
                    {&#39;prior_intercept_dist&#39;: &#39;normal&#39;, &#39;prior_intercept_mu&#39;: 1.5, &#39;prior_intercept_sigma&#39;: 0.4},
                    {&#39;prior_intercept_dist&#39;: &#39;normal&#39;, &#39;prior_intercept_mu&#39;: 1.5, &#39;prior_intercept_sigma&#39;: 0.5}],
              mask=[False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;prior_intercept&#39;: {&#39;prior_intercept_dist&#39;: &#39;normal&#39;,
    &#39;prior_intercept_mu&#39;: 1.5,
    &#39;prior_intercept_sigma&#39;: 0.1}},
  {&#39;prior_intercept&#39;: {&#39;prior_intercept_dist&#39;: &#39;normal&#39;,
    &#39;prior_intercept_mu&#39;: 1.5,
    &#39;prior_intercept_sigma&#39;: 0.2}},
  {&#39;prior_intercept&#39;: {&#39;prior_intercept_dist&#39;: &#39;normal&#39;,
    &#39;prior_intercept_mu&#39;: 1.5,
    &#39;prior_intercept_sigma&#39;: 0.30000000000000004}},
  {&#39;prior_intercept&#39;: {&#39;prior_intercept_dist&#39;: &#39;normal&#39;,
    &#39;prior_intercept_mu&#39;: 1.5,
    &#39;prior_intercept_sigma&#39;: 0.4}},
  {&#39;prior_intercept&#39;: {&#39;prior_intercept_dist&#39;: &#39;normal&#39;,
    &#39;prior_intercept_mu&#39;: 1.5,
    &#39;prior_intercept_sigma&#39;: 0.5}}],
 &#39;split0_test_score&#39;: array([0.91806388, 0.92037036, 0.92192078, 0.92145701, 0.9225362 ]),
 &#39;split1_test_score&#39;: array([0.92760653, 0.93139257, 0.92784184, 0.92879845, 0.92649572]),
 &#39;split2_test_score&#39;: array([0.92400341, 0.9251356 , 0.92539458, 0.92344662, 0.92393732]),
 &#39;split3_test_score&#39;: array([0.86246216, 0.86378672, 0.86572067, 0.86708639, 0.86581394]),
 &#39;split4_test_score&#39;: array([0.93539041, 0.94038093, 0.93999361, 0.94065174, 0.94060138]),
 &#39;mean_test_score&#39;: array([0.91350528, 0.91621324, 0.9161743 , 0.91628804, 0.91587691]),
 &#39;std_test_score&#39;: array([0.02613119, 0.0270552 , 0.02595032, 0.02549065, 0.02584444]),
 &#39;rank_test_score&#39;: array([5, 2, 3, 1, 4])}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gs_rez</span> <span class="o">=</span> <span class="n">grid_search</span><span class="o">.</span><span class="n">cv_results_</span>
<span class="n">gs_rez</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;mean_fit_time&#39;: array([5.30950308, 5.14737024, 5.56399112, 5.17774582, 5.22426496]),
 &#39;std_fit_time&#39;: array([0.06107001, 0.02645618, 0.3098849 , 0.13146148, 0.09319016]),
 &#39;mean_score_time&#39;: array([7.99337845, 7.90251842, 9.34669194, 7.75936437, 8.00935616]),
 &#39;std_score_time&#39;: array([0.13692504, 0.11199365, 1.5159354 , 0.24906021, 0.08258889]),
 &#39;param_prior_aux&#39;: masked_array(data=[{&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.1},
                    {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.325},
                    {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.55},
                    {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.775},
                    {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 1.0}],
              mask=[False, False, False, False, False],
        fill_value=&#39;?&#39;,
             dtype=object),
 &#39;params&#39;: [{&#39;prior_aux&#39;: {&#39;prior_aux_dist&#39;: &#39;exponential&#39;,
    &#39;prior_aux_param&#39;: 0.1}},
  {&#39;prior_aux&#39;: {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.325}},
  {&#39;prior_aux&#39;: {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.55}},
  {&#39;prior_aux&#39;: {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 0.775}},
  {&#39;prior_aux&#39;: {&#39;prior_aux_dist&#39;: &#39;exponential&#39;, &#39;prior_aux_param&#39;: 1.0}}],
 &#39;split0_test_score&#39;: array([0.92143333, 0.92266843, 0.91996582, 0.92183316, 0.92122403]),
 &#39;split1_test_score&#39;: array([0.92708067, 0.92636237, 0.92917565, 0.92988003, 0.92924314]),
 &#39;split2_test_score&#39;: array([0.92364268, 0.92406732, 0.92516504, 0.92541146, 0.92575936]),
 &#39;split3_test_score&#39;: array([0.86712565, 0.8654041 , 0.86609607, 0.86574883, 0.86919326]),
 &#39;split4_test_score&#39;: array([0.93955606, 0.93915569, 0.94056164, 0.94017218, 0.94107701]),
 &#39;mean_test_score&#39;: array([0.91576768, 0.91553158, 0.91619284, 0.91660913, 0.91729936]),
 &#39;std_test_score&#39;: array([0.02511586, 0.02573699, 0.02594924, 0.02616439, 0.02493673]),
 &#39;rank_test_score&#39;: array([4, 5, 3, 2, 1])}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_y</span> <span class="o">=</span> <span class="n">gs_rez2</span><span class="p">[</span><span class="s1">&#39;mean_test_score&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">param_range</span><span class="p">,</span> <span class="n">mean_y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Mean Test Score&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Prior Intercept $\sigma_</span><span class="se">\\</span><span class="s2">alpha$ Parameter&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Score with Gridsearch on Prior Intercept $\sigma_</span><span class="se">\\</span><span class="s2">alpha$ Parameter&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-intense-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-intense-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">c:\Users\alizm\Documents\FlatironInstitute\sk-stan-regression\docsrc\examples\Hyperparameter Optimization.ipynb Cell 17</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-intense-fg ansi-bold">()</span>
<span class="ansi-green-intense-fg ansi-bold">----&gt; &lt;a href=&#39;vscode-notebook-cell:/c%3A/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/docsrc/examples/Hyperparameter%20Optimization.ipynb#ch0000016?line=0&#39;&gt;1&lt;/a&gt;</span> mean_y = gs_rez2[&#39;mean_test_score&#39;]
<span class="ansi-green-fg">      &lt;a href=&#39;vscode-notebook-cell:/c%3A/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/docsrc/examples/Hyperparameter%20Optimization.ipynb#ch0000016?line=1&#39;&gt;2&lt;/a&gt;</span> plt.plot(param_range, mean_y[::-1])
<span class="ansi-green-fg">      &lt;a href=&#39;vscode-notebook-cell:/c%3A/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/docsrc/examples/Hyperparameter%20Optimization.ipynb#ch0000016?line=2&#39;&gt;3&lt;/a&gt;</span> plt.ylabel(&#34;Mean Test Score&#34;)

<span class="ansi-red-intense-fg ansi-bold">NameError</span>: name &#39;gs_rez2&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">floor_measure</span><span class="p">,</span> <span class="n">log_radon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
20:13:50 - cmdstanpy - INFO - CmdStan start processing
chain 1 |<span class="ansi-yellow-fg">          </span>| 00:00 Status




chain 1 |<span class="ansi-yellow-fg">█▊        </span>| 00:00 Iteration:  200 / 2000 [ 10%]  (Warmup)


chain 1 |<span class="ansi-yellow-fg">█████     </span>| 00:00 Iteration:  900 / 2000 [ 45%]  (Warmup)





chain 1 |<span class="ansi-blue-fg">███████▋  </span>| 00:02 Iteration: 1400 / 2000 [ 70%]  (Sampling)





chain 1 |<span class="ansi-blue-fg">█████████ </span>| 00:03 Iteration: 1700 / 2000 [ 85%]  (Sampling)


chain 1 |<span class="ansi-blue-fg">██████████</span>| 00:03 Iteration: 1900 / 2000 [ 95%]  (Sampling)

chain 1 |<span class="ansi-blue-fg">██████████</span>| 00:03 Sampling completed
chain 2 |<span class="ansi-blue-fg">██████████</span>| 00:03 Sampling completed
chain 3 |<span class="ansi-blue-fg">██████████</span>| 00:03 Sampling completed
chain 4 |<span class="ansi-blue-fg">██████████</span>| 00:03 Sampling completed
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

20:13:54 - cmdstanpy - INFO - CmdStan done processing.
20:13:54 - cmdstanpy - WARNING - Non-fatal error during sampling:
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
        Exception: normal_lpdf: Scale parameter is 0, but must be positive! (in &#39;C:/Users/alizm/Documents/FlatironInstitute/sk-stan-regression/scikit_stan/stan_files/glm_v_continuous.stan&#39;, line 71, column 4 to column 35)
Consider re-running with show_console=True if the above output is unclear!
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;scikit_stan.generalized_linear_regression.glm.GLM at 0x282ff350880&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glm</span><span class="o">.</span><span class="n">alpha_</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">beta_</span><span class="p">,</span> <span class="n">glm</span><span class="o">.</span><span class="n">sigma_</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1.3634094832324999, array([-0.58611448]), 0.7908575316030001)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">arviz</span> <span class="k">as</span> <span class="nn">az</span>
<span class="n">az</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;arviz-darkgrid&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span><span class="n">az</span><span class="o">.</span><span class="n">from_cmdstanpy</span><span class="p">(</span><span class="n">fitted</span><span class="o">.</span><span class="n">fitted_samples_</span><span class="p">)</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_trace</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;beta&quot;</span><span class="p">,</span> <span class="s2">&quot;sigma&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[&lt;AxesSubplot:title={&#39;center&#39;:&#39;alpha&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;alpha&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;beta&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;beta&#39;}&gt;],
       [&lt;AxesSubplot:title={&#39;center&#39;:&#39;sigma&#39;}&gt;,
        &lt;AxesSubplot:title={&#39;center&#39;:&#39;sigma&#39;}&gt;]], dtype=object)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/examples_Hyperparameter_Optimization_20_1.png" src="../_images/examples_Hyperparameter_Optimization_20_1.png" />
</div>
</div>
</section>


              </article>
              

              
              <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              </footer>
              
          </div>
          
      </div>
    </div>

  
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=92025949c220c2e29695"></script>

<footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    <p class="copyright">
    &copy; Copyright 2022, Alexey Izmailov, Brian Ward.<br>
</p>
  </div>
  
  <div class="footer-item">
    <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.2.<br>
</p>
  </div>
  
</div>
</footer>
  </body>
</html>